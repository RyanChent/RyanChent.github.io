var e=Object.defineProperty,a=Object.defineProperties,l=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,t=Object.prototype.propertyIsEnumerable,o=(a,l,s)=>l in a?e(a,l,{enumerable:!0,configurable:!0,writable:!0,value:s}):a[l]=s;import{i as u,t as i,s as n,f as v,r as c}from"./index.91574766.js";import{t as m,u as p,h as d,g,J as w,q as h,a5 as b,aX as f,w as y}from"./vendor.0c535a2d.js";const O=()=>{const e=m("isMobile"),a=p(),l=d(),s=l.currentRoute,r=g(a.state.lang.language),t=g(!1),o=w({username:"vite-manage",passwords:"vite-manage",verify:"",lang:r.value,noLogin:!1});return y((()=>[r.value,s.value.path]),(()=>{n(i(s.value.meta.title))})),{tabClick:()=>a.dispatch("setLanguage",r.value).then((()=>o.lang=r.value)),tab:r,userObj:o,userLogin:async s=>{u(o.username)?u(o.passwords)?(t.value=!0,await a.dispatch("login",o),t.value=!1,l.push("/"),h((()=>{e.value?b({type:"success",message:`${i("welcome")}, ${o.username}`}):f({title:i("login.success"),message:`${i("welcome")}, ${o.username}`,type:"success"})}))):s(i("please.input.something")+i("password")):s(i("please.input.something")+i("username"))},isMobile:e,logining:t}},j=()=>{let e;const i=m("isMobile"),n=d(),w=p(),b=g(60),f=g(0),y=g(""),O=g(!1),j=g({email:"",passwords:"",confirm:"",verify:""});return{timeout:b,param:j,isMobile:i,verify:y,loading:O,active:f,handleBack:()=>{O.value=!1,clearTimeout(e),n.back()},handleGetCaptcha:a=>{b.value=60,O.value=!0,v({email:a}).then((a=>{const l=()=>{e&&0===b.value?(O.value=!1,clearTimeout(e)):e=setTimeout((()=>{b.value-=1,l()}),1e3)};l(),y.value=a,setTimeout((()=>{y.value=""}),12e5)})).catch((()=>{O.value=!1}))},handleShowResetPwd:a=>{var l,s,r,t,o,i,n;return u(j.value.email)?u(j.value.verify)?(null==(t=(r=j.value.verify).toLowerCase)?void 0:t.call(r))!==(null==(i=(o=y.value).toLowerCase)?void 0:i.call(o))?(null==(n=a.error)||n.call(a,"验证码输入错误"),!1):(clearTimeout(e),O.value=!1,void(f.value=1)):(null==(s=a.error)||s.call(a,"请输入验证码"),!1):(null==(l=a.error)||l.call(a,"请先获取验证码"),!1)},handleResetPwd:i=>{var v,m;return u(j.value.passwords)?j.value.passwords!==j.value.confirm?(null==(m=i.error)||m.call(i,"两次输入密码不一致"),!1):(O.value=!0,void c({email:j.value.email,passwords:j.value.passwords}).then((async i=>{O.value=!1,f.value=2,u(i.username)&&(await h(),e=setTimeout((()=>{var e,u;w.dispatch("login",(e=((e,a)=>{for(var l in a||(a={}))r.call(a,l)&&o(e,l,a[l]);if(s)for(var l of s(a))t.call(a,l)&&o(e,l,a[l]);return e})({},i),u={passwords:j.value.passwords,lang:"zh-cn"},a(e,l(u)))).then((()=>n.push("/")))}),5e3))})).catch((()=>{O.value=!1}))):(null==(v=i.error)||v.call(i,"请输入密码"),!1)}}},P=()=>({isMobile:m("isMobile"),param:g({email:"",username:"",passwords:"",confirm:""})});export{j as a,P as b,O as u};

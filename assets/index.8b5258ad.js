var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,l=(t,a,o)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[a]=o;import{d as i,r,f as c,g as h,C as u,E as p,c as d,m as v,F as w,I as m}from"./vendor.0ef042a4.js";import{t as g,p as y,d as U,i as f,e as S,h as b}from"./index.c6686f16.js";const A=i({name:"Profile",componentName:"ManageMobileProfile",props:{user:{type:Object,default:()=>({})},modelValue:Boolean},setup:()=>({showPreview:r(!1)}),render(){return c("header",{onClick:e=>{e.stopPropagation(),this.$emit("update:modelValue",!0)}},[c(h("van-image-preview"),{images:[this.user.avatar],show:this.showPreview,"onUpdate:show":e=>this.showPreview=e,showIndex:!1},null),c(h("van-image"),{width:70,fit:"cover",height:70,src:this.user.avatar,radius:19,style:"border: solid 1px #d9d9d9",onClick:e=>{e.stopPropagation(),this.showPreview=!0}},{loading:()=>c(h("van-loading"),{type:"spinner",size:"20"},null),error:()=>c("span",null,[u("加载失败")])}),c("div",{class:"desc"},[c("p",null,[c("b",null,[this.user.username])]),c("p",null,[u("邮箱："),this.user.email])]),c(h("van-icon"),{name:"arrow"},null)])}}),k=()=>{const e=r(!1),t=r(""),a=r([]);return{showActionSheet:e,actions:a,touchToShowAction:(o,s,n)=>{o.stopPropagation(),a.value=s,t.value=n,e.value=!0},tag:t}},P={username:"名字",signature:"签名",email:"邮箱"},C=function(){return c(h("van-action-sheet"),v({show:this.showActionSheet,"onUpdate:show":e=>this.showActionSheet=e},Object.assign({position:"bottom","cancel-text":"返回","close-on-popstate":!0,"close-on-click-action":!0},this.actions.length&&{actions:this.actions,onSelect:(e,t)=>this.ActionSelect(e,t,this.$toast)})),{default:()=>["role"!==this.tag&&c("div",null,[c(h("van-field"),{label:P[this.tag],modelValue:this.copyUser[this.tag],"onUpdate:modelValue":e=>this.copyUser[this.tag]=e,placeholder:`请输入${P[this.tag]}`,size:"large",center:!0,colon:!0,"label-width":"80px","label-align":"center",clearable:!0},null),c(h("van-button"),{class:"van-action-sheet__cancel",plain:!0,type:"primary",onClick:e=>{e.stopPropagation(),this.copyUser[this.tag]!==this.user[this.tag]&&(this.copyUser.updateDate=y(new Date),this.$emit("update:user",this.copyUser)),this.showActionSheet=!1}},{default:()=>[u("确定")]})])]})},O=function(){const e=h("MobileUpload");return c(w,null,[c(h("van-cell"),{center:!0,title:"头像","is-link":!0},{default:()=>c(h("van-image"),{width:70,fit:"cover",height:70,src:this.copyUser.avatar,radius:19,style:"border: solid 1px #d9d9d9",onClick:e=>{e.stopPropagation(),this.showAvatar=!0}},{loading:()=>c(h("van-loading"),{type:"spinner",size:"20"},null),error:()=>c("span",null,[u("加载失败")])})}),c(h("van-dialog"),{show:this.showAvatar,"onUpdate:show":e=>this.showAvatar=e,showConfirmButton:!1,closeOnClickOverlay:!0,class:"avatar-upload-dialog"},{default:()=>[c(e,{modelValue:[f(this.copyUser.avatar)&&{url:this.copyUser.avatar}],maxCount:1,"onUpdate:modelValue":e=>{var t,a,o;Object.assign(this.copyUser,{avatar:null!=(o=null==(t=e[0])?void 0:t.url)?o:null==(a=e[0])?void 0:a.content,updateDate:y(new Date)}),f(this.copyUser.avatar)&&(this.$emit("update:user",this.copyUser),this.showAvatar=!1)}},null)]})])},x=i({name:"UserDetail",componentName:"ManageUserDetail",props:{user:{type:Object,default:()=>({})},modelValue:{type:Boolean,default:!1}},setup:(e,{emit:t})=>((e,t)=>{const{actions:a,touchToShowAction:o,tag:s,showActionSheet:n}=k(),l=r(U(p(e.user))),i=d({get:()=>e.modelValue,set(e){t("update:modelValue",e)}});return{copyUser:l,back:i,actions:a,ActionSelect:(e,a,o)=>{"role"===s.value&&e.action!==l.value.role&&(Object.assign(l.value,{role:e.action,updateDate:y(new Date)}),o("部分权限改变"),t("update:user",l.value))},touchToShowAction:o,tag:s,showActionSheet:n,showAvatar:r(!1)}})(e,t),render(){return c("section",{class:"user-page-detail"},[O.call(this),c(h("van-cell"),{center:!0,title:"名字",value:this.copyUser.username,"is-link":!0,onClick:()=>{this.tag="username",this.showActionSheet=!0}},null),c(h("van-cell"),{center:!0,title:"角色",value:g(this.copyUser.role),"is-link":!0,onClick:e=>{this.touchToShowAction(e,[{name:g("admin"),action:"admin"},{name:g("customer"),action:"customer"}],"role")}},null),c(h("van-cell"),{center:!0,title:"个性签名",value:this.copyUser.signature,"is-link":!0,onClick:()=>{this.tag="signature",this.showActionSheet=!0}},null),c(h("van-cell"),{center:!0,title:"邮箱",value:this.copyUser.email,"is-link":!0,onClick:()=>{this.tag="email",this.showActionSheet=!0}},null),c(h("van-cell"),{center:!0,title:"创建日期",value:y(this.copyUser.createDate)},null),c(h("van-cell"),{center:!0,title:"修改日期",value:y(this.copyUser.updateDate)},null),c(h("van-button"),{plain:!0,hairline:!0,block:!0,round:!0,type:"primary",style:{margin:"40px 16px 0",width:"calc(100% - 32px)"},onClick:()=>this.back=!1},{default:()=>[u("返回")]}),C.call(this)])}});const V=i({name:"UserPageView",componentName:"ManageMobileUser",components:{profile:A,UserDetail:x,ColorPicker:i(S)},setup(e,{emit:i}){const{showShare:c,user:h,options:u,ShareSelect:p}=b(e,i),{actions:d,touchToShowAction:v,tag:w,showActionSheet:m}=k();return{showShare:c,options:u,user:h,showUserInfo:r(!1),showActionSheet:m,actions:d,tag:w,touchToShowAction:v,ActionSelect:(e,i)=>{var r,c;"lang"===w.value&&h.value.lang!==e.action&&(h.value=(r=((e,t)=>{for(var a in t||(t={}))s.call(t,a)&&l(e,a,t[a]);if(o)for(var a of o(t))n.call(t,a)&&l(e,a,t[a]);return e})({},h.value),c={lang:e.action},t(r,a(c))))},ShareSelect:p}},render(){return c("main",null,[c("section",{class:"user-page",style:{display:this.showUserInfo?"none":"block"}},[c(A,{user:this.user,modelValue:this.showUserInfo,"onUpdate:modelValue":e=>this.showUserInfo=e},null),c(h("van-cell"),{center:!0,title:"多语言","is-link":!0,onClick:e=>this.touchToShowAction(e,[{name:g("zh-cn"),action:"zh-cn"},{name:g("en"),action:"en"}],"lang")},null),c(h("van-cell"),{center:!0,title:"主题色",class:"theme-color"},{default:()=>[c(S,null,null)]}),c(h("van-cell"),{center:!0,title:"分享",onClick:()=>this.showShare=!0,"is-link":!0},null),c(h("van-cell"),{center:!0,title:"建议与反馈","is-link":!0},null),c(h("van-cell"),{center:!0,title:"退出登录","is-link":!0,to:"/login"},null),c(h("van-notice-bar"),{scrollable:!0,text:"移动端目前正在加紧速度开发中，敬请期待。",style:"margin-top: 30px"},null),c(h("van-share-sheet"),{show:this.showShare,"onUpdate:show":e=>this.showShare=e,title:"立即分享给好友",options:this.options,onSelect:this.ShareSelect},null),c(h("van-action-sheet"),{show:this.showActionSheet,"onUpdate:show":e=>this.showActionSheet=e,actions:this.actions,"cancel-text":"返回","close-on-popstate":!0,"close-on-click-action":!0,onSelect:this.ActionSelect},null)]),c(m,{"enter-active-class":"animated fadeIn"},{default:()=>[this.showUserInfo&&c(h("user-detail"),{user:this.user,"onUpdate:user":e=>this.user=e,modelValue:this.showUserInfo,"onUpdate:modelValue":e=>this.showUserInfo=e},null)]})])}});export default V;

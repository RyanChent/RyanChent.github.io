import{d as e,g as t,c as o,r as n,v as s,m as a,l as i,f as l,a7 as c,u as r,T as h,ae as u}from"./vendor.998e70d8.js";import{t as p,p as d,c as m,s as w}from"./index.4991e6f5.js";const f=e({name:"Profile",componentName:"ManageMobileProfile",props:{userInfo:{type:Object,default:()=>({})},modelValue:Boolean},setup:()=>({showPreview:t(!1)}),render(){return o("header",{onClick:e=>{e.stopPropagation(),this.$emit("update:modelValue",!0)}},[o(n("van-image-preview"),s({images:[this.userInfo.avatar],show:this.showPreview,showIndex:!1},{"onUpdate:show":e=>this.showPreview=e}),null),o(n("van-image"),{width:80,fit:"cover",height:80,src:this.userInfo.avatar,radius:19,style:"border: solid 1px #d9d9d9",onClick:e=>{e.stopPropagation(),this.showPreview=!0}},{loading:()=>o(n("van-loading"),{type:"spinner",size:"20"},null),error:()=>o("span",null,[a("加载失败")])}),o("div",{class:"desc"},[o("p",null,[o("b",null,[this.userInfo.username])]),o("p",null,[a("邮箱："),this.userInfo.email])]),o(n("van-icon"),{name:"arrow"},null)])}}),v=()=>{const e=t(!1),o=t(""),n=t([]);return{showActionSheet:e,actions:n,touchToShowAction:(t,s,a)=>{t.stopPropagation(),n.value=s,o.value=a,e.value=!0},tag:o}},g=e({name:"userDetail",componentName:"ManageUserDetail",props:{userInfo:{type:Object,default:()=>({})},modelValue:{type:Boolean,default:!1}},setup(e,{emit:t}){const{proxy:o}=c(),{actions:n,touchToShowAction:s,tag:a,showActionSheet:r}=v(),h=i("updateRoutes"),u=o.$store;return{back:l({get:()=>e.modelValue,set(e){t("update:modelValue",e)}}),actions:n,touchToShowAction:s,tag:a,showActionSheet:r,ActionSelect:(t,n)=>{switch(a.value){case"role":t.action!==e.userInfo.role&&Promise.all([u.dispatch("setUserInfo",Object.assign({},e.userInfo,{role:t.action})),u.dispatch("getInfo",[t.action])]).then((()=>{o.$toast("部分权限改变"),h()}))}}}},render(){return o("section",{class:"user-page-detail"},[o(n("van-cell"),{center:!0,title:"头像","is-link":!0},{default:()=>o(n("van-image"),{width:70,fit:"cover",height:70,src:this.userInfo.avatar,radius:19,style:"border: solid 1px #d9d9d9"},{loading:()=>o(n("van-loading"),{type:"spinner",size:"20"},null),error:()=>o("span",null,[a("加载失败")])})}),o(n("van-cell"),{center:!0,title:"名字",value:this.userInfo.username,"is-link":!0},null),o(n("van-cell"),{center:!0,title:"角色",value:p(this.userInfo.role),"is-link":!0,onClick:e=>{this.touchToShowAction(e,[{name:p("admin"),action:"admin"},{name:p("customer"),action:"customer"}],"role")}},null),o(n("van-cell"),{center:!0,title:"个性签名",value:this.userInfo.signature,"is-link":!0},null),o(n("van-cell"),{center:!0,title:"邮箱",value:this.userInfo.email,"is-link":!0},null),o(n("van-cell"),{center:!0,title:"创建日期",value:d(this.userInfo.createDate)},null),o(n("van-cell"),{center:!0,title:"修改日期",value:d(this.userInfo.updateDate)},null),o(n("van-button"),{plain:!0,hairline:!0,block:!0,round:!0,type:"primary",style:{margin:"40px 16px 0",width:"calc(100% - 32px)"},onClick:()=>this.back=!1},{default:()=>[a("返回")]}),o(n("van-action-sheet"),{show:this.showActionSheet,"onUpdate:show":e=>this.showActionSheet=e,position:"bottom",actions:this.actions,"cancel-text":"返回","close-on-popstate":!0,"close-on-click-action":!0,onSelect:this.ActionSelect},null)])}});const k=e({name:"UserPageView",componentName:"ManageMobileUser",components:{profile:f,UserDetail:g},setup(){const e=r(),{showShare:o,userInfo:n,options:s,ShareSelect:a}=(e=>({showShare:t(!1),userInfo:l((()=>e.state.user.userInfo)),options:[[{name:"微信",icon:"wechat",key:"wechat"},{name:"朋友圈",icon:"wechat-moments",key:"wechat-moments"},{name:"微博",icon:"weibo",key:"weibo"},{name:"QQ",icon:"qq",key:"qq"},{name:"QQ空间",key:"qzone",icon:"https://ss3.bdstatic.com/70cFv8Sh_Q1YnxGkpoWK1HF6hhy/it/u=1577376065,62724058&fm=26&gp=0.jpg"}],[{name:"复制链接",icon:"link",key:"link"},{name:"分享海报",icon:"poster",key:"poster"},{name:"二维码",icon:"qrcode",key:"qrcode"}]],ShareSelect:e=>{switch(e.key){case"weibo":case"link":m(location.href).then((()=>u.success("复制成功")));break;case"poster":case"qrcode":case"wechat":case"wechat-moments":case"weibo":case"qq":window.open(`http://connect.qq.com/widget/shareqq/index.html?url=${location.href}?sharesource=qzone&title=${document.title}&pics=${location.origin}/favicon.ico&summary=vite-backen-cli`);break;case"qzone":window.open(`https://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=${location.href}?sharesource=qzone&title=${document.title}&pics=${location.origin}/favicon.ico&summary=vite-backen-cli`)}}}))(e),{actions:i,touchToShowAction:c,tag:h,showActionSheet:d}=v();return{showShare:o,options:s,userInfo:n,showUserInfo:t(!1),showActionSheet:d,actions:i,tag:h,touchToShowAction:c,ActionSelect:(t,o)=>{switch(h.value){case"lang":e.dispatch("setLanguage",t.action).then((()=>{w(p("user-page")),u(p("change-language-success"))}))}},ShareSelect:a}},render(){return o("main",null,[o("section",{class:"user-page",style:{display:this.showUserInfo?"none":"block"}},[o(f,{userInfo:this.userInfo,modelValue:this.showUserInfo,"onUpdate:modelValue":e=>this.showUserInfo=e},null),o(n("van-cell"),{center:!0,title:"多语言","is-link":!0,onClick:e=>this.touchToShowAction(e,[{name:p("zh-cn"),action:"zh-cn"},{name:p("en"),action:"en"}],"lang")},null),o(n("van-cell"),{center:!0,title:"主题色","is-link":!0},null),o(n("van-cell"),{center:!0,title:"分享",onClick:()=>this.showShare=!0,"is-link":!0},null),o(n("van-cell"),{center:!0,title:"建议与反馈","is-link":!0},null),o(n("van-cell"),{center:!0,title:"退出登录","is-link":!0,to:"/login"},null),o(n("van-notice-bar"),{scrollable:!0,text:"移动端目前正在加紧速度开发中，敬请期待。",style:"margin-top: 30px"},null),o(n("van-share-sheet"),{show:this.showShare,"onUpdate:show":e=>this.showShare=e,title:"立即分享给好友",options:this.options,onSelect:this.ShareSelect},null),o(n("van-action-sheet"),{show:this.showActionSheet,"onUpdate:show":e=>this.showActionSheet=e,actions:this.actions,"cancel-text":"返回","close-on-popstate":!0,"close-on-click-action":!0,onSelect:this.ActionSelect},null)]),o(h,{"enter-active-class":"animated fadeIn"},{default:()=>[this.showUserInfo&&o(n("user-detail"),{userInfo:this.userInfo,modelValue:this.showUserInfo,"onUpdate:modelValue":e=>this.showUserInfo=e},null)]})])}});export default k;
